diff -crB turbsim_build_structure/nwtc/source/Makefile turbsim_build_structure_mod/nwtc/source/Makefile
*** turbsim_build_structure/nwtc/source/Makefile	2012-11-16 14:51:11.000000000 -0700
--- turbsim_build_structure_mod/nwtc/source/Makefile	2015-02-18 17:15:34.746704132 -0700
***************
*** 1,48 ****
  FC = gfortran
- FFLAGS = -x f95-cpp-input -ffree-line-length-none
- 
- SOURCES_STD =  \
-   ModMesh.f90 \
-   NWTC_Aero.f90 \
-   NWTC_IO.f90 \
-   NWTC_Library.f90 \
-   NWTC_Num.f90 \
-   SingPrec.f90
- 
- SOURCES_SYS = SysGnuLinux.f90
- 
- SOURCES = $(SOURCES_STD) $(SOURCES_SYS)
- 
- OBJ = $(SOURCES:.f90=.o)
- 
- .SUFFIXES : .f90 .o
- 
- .f90.o:
- 	$(FC) $(FFLAGS) $(INCLUDE) $< -c -o $@
- 
- default: libnwtc.a
- 
- libnwtc.a : $(OBJ)
- 	ar cr libnwtc.a $(OBJ)
- 	ranlib libnwtc.a
  
  clean:
! 	/bin/rm -f *.o *.mod *.a
! 
! ### DO NOT DELETE OR EDIT THIS LINE
! # Everything from here on down is generated by f90depend
! # so do NOT add any translation rules below here.
! 
! 
! 
! #--- Module-Dependencies
! 
! NWTC_Aero.o: NWTC_IO.o NWTC_Num.o
! NWTC_IO.o: SysGnuLinux.o
! NWTC_Library.o: NWTC_Aero.o ModMesh.o
! NWTC_Num.o: NWTC_IO.o
! SysGnuLinux.o: SingPrec.o
! ModMesh.o: SingPrec.o
! 
! 
! 
--- 1,43 ----
  FC = gfortran
  
+ SRC = DoubPrec.f90
+ SRC += ModMesh.f90
+ SRC += SysGnuLinux.f90
+ SRC += NWTC_IO.f90
+ SRC += NWTC_Num.f90
+ SRC += NWTC_Aero.f90
+ SRC += NWTC_Library.f90
+ 
+ OBJ = $(SRC:.f90=.o)
+ 
+ ifdef BASEDIR
+ 	INCLUDE = $(BASEDIR)/include
+ 	MODDIR = $(BASEDIR)/include
+ else
+ 	MODDIR = ./
+ endif
+ 
+ ifndef OUTDIR
+ 	OUTDIR = ./
+ endif
+ 
+ all: checkdir $(SRC:.f90=.d) $(addprefix $(OUTDIR)/,$(OBJ))
+ 
+ $(OUTDIR)/%.o: %.f90
+ 	$(FC) $(FFLAGS) -c $< -o $@ -J$(MODDIR)	-I$(INCLUDE)
+ 
+ %.d: %.f90
+ 	@set -e; rm -f $@; \
+ 	$(FC) -E -cpp -MM $< -MF $@.$$$$ > /dev/null; \
+ 	sed 's,\($*\)\.o[ :]*,\1.o $@ : ,g' < $@.$$$$ > $@; \
+ 	rm -f $@.$$$$
+ 
+ checkdir:
+ 	@mkdir -p $(OUTDIR); \
+ 	mkdir -p $(MODDIR);
+ 
+ -include $(SRC:.f90=.d)
+       
+ .PHONY: clean checkdir
  clean:
! 	rm -rf *.d *.s $(OUTDIR)/*.o
diff -crB turbsim_build_structure/nwtc/source/SysGnuLinux.f90 turbsim_build_structure_mod/nwtc/source/SysGnuLinux.f90
*** turbsim_build_structure/nwtc/source/SysGnuLinux.f90	2012-12-12 14:17:38.000000000 -0700
--- turbsim_build_structure_mod/nwtc/source/SysGnuLinux.f90	2015-02-18 17:15:22.102703651 -0700
***************
*** 732,738 ****
  
  
  
!    WRITE (CU,'(''+'',A)')  Str
  
  
     RETURN
--- 732,738 ----
  
  
  
!    WRITE (CU,'(A)',ADVANCE='NO')  Str//CHAR(13)
  
  
     RETURN
diff -crB turbsim_build_structure/nwtc/source/SysMatlab.f90 turbsim_build_structure_mod/nwtc/source/SysMatlab.f90
*** turbsim_build_structure/nwtc/source/SysMatlab.f90	2012-12-12 14:17:38.000000000 -0700
--- turbsim_build_structure_mod/nwtc/source/SysMatlab.f90	2015-02-18 17:15:22.106703651 -0700
***************
*** 46,52 ****
     LOGICAL, PARAMETER            :: KBInputOK   = .FALSE.                           ! A flag to tell the program that keyboard input is allowed in the environment.
  
     CHARACTER(10), PARAMETER      :: Endian      = 'BIG_ENDIAN'                      ! The internal format of numbers.
!    CHARACTER( 1), PARAMETER      :: PathSep     = '\'                               ! The path separater.
     CHARACTER( 1), PARAMETER      :: SwChar      = '/'                               ! The switch character for command-line options.
     CHARACTER(11), PARAMETER      :: UnfForm     = 'UNFORMATTED'                     ! The string to specify unformatted I/O files.
  
--- 46,52 ----
     LOGICAL, PARAMETER            :: KBInputOK   = .FALSE.                           ! A flag to tell the program that keyboard input is allowed in the environment.
  
     CHARACTER(10), PARAMETER      :: Endian      = 'BIG_ENDIAN'                      ! The internal format of numbers.
!    CHARACTER( 1), PARAMETER      :: PathSep     = '/'                               ! The path separater.
     CHARACTER( 1), PARAMETER      :: SwChar      = '/'                               ! The switch character for command-line options.
     CHARACTER(11), PARAMETER      :: UnfForm     = 'UNFORMATTED'                     ! The string to specify unformatted I/O files.
  
***************
*** 61,67 ****
        ! corresponding to a file unit number or returns -1 on error.
  
  
!    USE                             IFPORT
  
  
        ! Argument declarations:
--- 61,67 ----
        ! corresponding to a file unit number or returns -1 on error.
  
  
!    !USE                             IFPORT
  
  
        ! Argument declarations:
***************
*** 162,168 ****
        ! It is especially useful when printing "running..." type messages.
  
  
!    USE                             IFPORT
  
  
        ! Argument declarations:
--- 162,168 ----
        ! It is especially useful when printing "running..." type messages.
  
  
!    !USE                             IFPORT
  
  
        ! Argument declarations:
***************
*** 242,248 ****
        ! This routine retrieves the path of the current working directory.
  
  
!    USE                             IFPORT
  
     IMPLICIT                        NONE
  
--- 242,248 ----
        ! This routine retrieves the path of the current working directory.
  
  
!    !USE                             IFPORT
  
     IMPLICIT                        NONE
  
***************
*** 267,273 ****
     ! Note: The functionality in this routine was replaced by GET_ENVIRONMENT_VARIABLE(), which will be available intrinsically in Fortran 2000.
  
  
!    USE                             IFPORT
  
  
        ! Function declaration.
--- 267,273 ----
     ! Note: The functionality in this routine was replaced by GET_ENVIRONMENT_VARIABLE(), which will be available intrinsically in Fortran 2000.
  
  
!    !USE                             IFPORT
  
  
        ! Function declaration.
***************
*** 295,301 ****
        ! It should be replaced with IEEE_IS_NAN in new code, but remains here for
        ! backwards compatibility.
  
!    USE                             IFPORT !remove with use of next line (not implemented in all versions of the IVF compiler)
  !  USE, INTRINSIC :: ieee_arithmetic
  
  
--- 295,301 ----
        ! It should be replaced with IEEE_IS_NAN in new code, but remains here for
        ! backwards compatibility.
  
!    !USE                             IFPORT !remove with use of next line (not implemented in all versions of the IVF compiler)
  !  USE, INTRINSIC :: ieee_arithmetic
  
  
diff -crB turbsim_build_structure/turbsim/Source/TSsubs.f90 turbsim_build_structure_mod/turbsim/Source/TSsubs.f90
*** turbsim_build_structure/turbsim/Source/TSsubs.f90	2012-09-25 13:41:58.000000000 -0600
--- turbsim_build_structure_mod/turbsim/Source/TSsubs.f90	2015-02-18 17:15:22.110703652 -0700
***************
*** 3157,3163 ****
        IF ( KHtest ) THEN
  
           CText = 'les'
!          CTEventFile = TRIM(CTEventPath)//'\Events.xtm'
  
           CALL WrScr( ' LES events will be used for the KH test.' )
  
--- 3157,3163 ----
        IF ( KHtest ) THEN
  
           CText = 'les'
!          CTEventFile = TRIM(CTEventPath)//'/Events.xtm'
  
           CALL WrScr( ' LES events will be used for the KH test.' )
  
***************
*** 3177,3183 ****
               ENDIF
           ENDIF
  
!          CTEventFile = TRIM(CTEventPath)//'\Events.'//TRIM(CText)
  
        ENDIF
  
--- 3177,3183 ----
               ENDIF
           ENDIF
  
!          CTEventFile = TRIM(CTEventPath)//'/Events.'//TRIM(CText)
  
        ENDIF
  
***************
*** 7823,7829 ****
  
  
        WRITE ( InpFile, '(I5.5)' ) EventName( PtrCurr%EventNum )
!       InpFile = TRIM( CTEventPath )//'\Event'//TRIM( InpFile)//'.dat'
  
        CALL OpenFInpFile( UnIn, InpFile )
  
--- 7823,7829 ----
  
  
        WRITE ( InpFile, '(I5.5)' ) EventName( PtrCurr%EventNum )
!       InpFile = TRIM( CTEventPath )//'/Event'//TRIM( InpFile)//'.dat'
  
        CALL OpenFInpFile( UnIn, InpFile )
  
